---
profile::dns::bind::domain: 'example.com'
profile::dns::bind::listen_on:
- '127.0.0.0'
- "%{facts.ipaddress_eth1}"
profile::dns::bind::hash_data:
  ns:
    owner: "%{lookup('profile::dns::resolv::nameserver')}"
  rac112a:
    owner: '192.168.5.30'
  rac112a-priv:
    owner: '192.168.6.30'
  rac112a-vip:
    owner: '192.168.5.40'
  rac112b:
    owner: '192.168.5.31'
  rac112b-priv:
    owner: '192.168.6.31'
  rac112b-vip:
    owner: '192.168.5.41'
  rac121a:
    owner: '192.168.5.50'
  rac121a-priv:
    owner: '192.168.6.50'
  rac121b:
    owner: '192.168.5.51'
  rac121b-priv:
    owner: '192.168.6.51'
  rac121b-vip:
    owner: '192.168.5.61'
  rac121a-vip:
    owner: '192.168.5.60'
  rac122a:
    owner: '192.168.5.70'
  rac122a-priv:
    owner: '192.168.6.70'
  rac122a-vip:
    owner: '192.168.5.80'
  rac122b:
    owner: '192.168.5.71'
  rac122b-priv:
    owner: '192.168.6.71'
  rac122b-vip:
    owner: '192.168.5.81'
  rac180a:
    owner: '192.168.5.110'
  rac180a-priv:
    owner: '192.168.6.110'
  rac180a-vip:
    owner: '192.168.5.120'
  rac180b:
    owner: '192.168.5.111'
  rac180b-priv:
    owner: '192.168.6.111'
  rac180b-vip:
    owner: '192.168.5.121'
  rac190a:
    owner: '192.168.5.90'
  rac190a-priv:
    owner: '192.168.6.90'
  rac190a-vip:
    owner: '192.168.5.100'
  rac190b:
    owner: '192.168.5.91'
  rac190b-priv:
    owner: '192.168.6.91'
  rac190b-vip:
    owner: '192.168.5.101'
  scan112:
    owner:
    - '192.168.5.37'
    - '192.168.5.38'
    - '192.168.5.39'
  scan121:
    owner:
    - '192.168.5.57'
    - '192.168.5.58'
    - '192.168.5.59'
  scan122:
    owner:
    - '192.168.5.77'
    - '192.168.5.78'
    - '192.168.5.79'
  scan180:
    owner:
    - '192.168.5.117'
    - '192.168.5.118'
    - '192.168.5.119'
  scan190:
    owner:
    - '192.168.5.97'
    - '192.168.5.98'
    - '192.168.5.99'
profile::dns::bind::forwarders:
- '8.8.8.8'
- '8.8.4.4'


#------------------------------------------------------------------------------
#
# Set lookup merge behaviour
#
#------------------------------------------------------------------------------
lookup_options:
  "^ora_profile::database::(.*)::(.*)":
    merge:
      strategy: deep
      merge_hash_arrays: true
  ora_profile::database::asm_diskgroup::disks:
    merge:
      strategy: first
  ora_profile::database::db_patches::patch_list:
    merge:
      strategy: first

# ------------------------------------------------------------------------------
#
# Settings for database
#
# ------------------------------------------------------------------------------
ora_profile::database::source:                                   /vagrant/software/files
ora_profile::database::ora_inventory_dir:                        /u01/app
ora_profile::database::db_definition::container_database:        enabled
ora_profile::database::db_definition::system_password:           Welcome01
ora_profile::database::db_definition::sys_password:              Change_on_1nstall
ora_profile::database::db_definition::data_file_destination:     +DATA
ora_profile::database::db_definition::recovery_area_destination: +RECO
ora_profile::database::db_startup::db_type:                      grid
ora_profile::database::db_control_provider:                      srvctl
ora_profile::database::storage:                                  asm
# ------------------------------------------------------------------------------
#
# Settings for database::sysctl
#
# ------------------------------------------------------------------------------
ora_profile::database::sysctl::list:
  'fs.file-max':
    value:  6815744
  'fs.aio-max-nr':
    value:  1048576
  'net.ipv4.ip_local_port_range':
    value:  '9000 65500'
  'net.core.rmem_default':
    value:  262144
  'net.core.rmem_max':
    value:  4194304
  'net.core.wmem_default':
    value:  262144
  'net.core.wmem_max':
    value:  1048576
  'vm.swappiness':
    value: 1
  'vm.dirty_background_ratio':
    value: 3
  'vm.dirty_ratio':
    value: 80
  'vm.dirty_expire_centisecs':
    value: 500
  'vm.dirty_writeback_centisecs':
    value: 100
  # # On Oracle Linux defaults
  # 'kernel.sem':
  #   value:  '32000      1024000000      500     32000'
  # 'kernel.shmall':
  #   value:  18446744073692774399
  # 'kernel.shmmax':
  #   value:  18446744073692774399
  # 'kernel.panic_on_oops':
  #   value:  1

# ------------------------------------------------------------------------------
#
# Settings for database::limits
#
# ------------------------------------------------------------------------------
ora_profile::database::limits::list:
  '*/nofile':
    soft: 2048
    hard: 65536
  '*/stack':
    soft: 10240
  "%{::ora_profile::database::os_user}/memlock":
    soft: 262144000
    hard: 262144000

# ------------------------------------------------------------------------------
#
# Settings for database::asm_packages
#
# ------------------------------------------------------------------------------
ora_profile::database::asm_packages::list:
  nfs-utils: {}
  cvuqdisk:
    ensure:   installed
    source:   "/vagrant/software/cvuqdisk-1.0.10-1.rpm"
    provider: rpm
    require:
      - Package[smartmontools]
      - Package[nfs-utils]
      - Group[%{::ora_profile::database::install_group}]


# ------------------------------------------------------------------------------
#
#  Settings for database::firewall
#
# ------------------------------------------------------------------------------
ora_profile::database::firewall::ports:
  '300 Allow SQLNET on port 1521':
    port: 1521
  '301 Allow Enterprise Manager on port 3782':
    port: 3872
  '302 Allow Multicast Domain Name Service (udp) for gpnpd':
    port: 5353
    protocol: udp
  '303 Allow Multicast Domain Name Service (tcp) for gpnpd':
    port: 5353
    protocol: tcp
  '304 Allow Cluster Synchronization Service daemon (CSSD)':
    port: 42414
    protocol: udp
  '305 Allow Oracle Grid Interprocess Communication for gipcd and ohasd':
    port: 42424
    protocol: udp
  '306 Allow Oracle Notification Services (ONS) local':
    port: 6100
  '307 Allow Oracle Notification Services (ONS) remote':
    port: 6200

